---
apiVersion: batch/v1
kind: CronJob
metadata:
  name: cnpg-restore-test
spec:
  # Poll for a newly completed backup and run once per new backup.
  schedule: "*/10 * * * *"
  jobTemplate:
    spec:
      template:
        spec:
          containers:
            - name: restore-test
              env:
                - name: SOURCE_CLUSTER
                  value: sparkyfitness-db
                - name: RESTORE_CLUSTER
                  value: sparkyfitness-db-restore
                - name: EXPECTED_DATABASE
                  value: sparkyfitness_db
                - name: EXPECTED_ROLE
                  value: sparky
                - name: BARMAN_OBJECT_NAME
                  value: sparkyfitness-db-store
