apiVersion: v1
kind: ConfigMap
metadata:
  name: sparkyfitness-server-config
  namespace: sparkyfitness
data:
  # Runtime / non-secret settings (substituted from cluster secrets by Kustomize postBuild)
  TZ: ${TIMEZONE}
  NODE_ENV: production
  SPARKY_FITNESS_LOG_LEVEL: ERROR

  # Feature toggles / optional behavior
  SPARKY_FITNESS_DISABLE_SIGNUP: "false"
  SPARKY_FITNESS_FORCE_EMAIL_LOGIN: "true"

  # Database connection details (non-secret; credentials come from Postgres secret)
  SPARKY_FITNESS_DB_HOST: sparkyfitness-db-rw.sparkyfitness.svc.cluster.local
  SPARKY_FITNESS_DB_PORT: "5432"
  SPARKY_FITNESS_DB_NAME: sparkyfitness_db

  # CORS / public URL for the frontend
  SPARKY_FITNESS_FRONTEND_URL: "https://sparkyfitness.${SECRET_DOMAIN}"

  # Optional email settings (leave host empty to disable email functionality)
  SPARKY_FITNESS_EMAIL_HOST: ""
  SPARKY_FITNESS_EMAIL_PORT: "587"
  SPARKY_FITNESS_EMAIL_SECURE: "false"
  SPARKY_FITNESS_EMAIL_FROM: ""

  # Garmin integration (leave URL empty to disable)
  GARMIN_MICROSERVICE_URL: ""
  GARMIN_SERVICE_PORT: "8000"
  GARMIN_SERVICE_IS_CN: "false"

  # Volume path variables are primarily for docker-compose; included for parity.
  # In Kubernetes these are handled by volume mounts.
  DB_PATH: ""
  SERVER_BACKUP_PATH: "/backup"
  SERVER_UPLOADS_PATH: "/uploads"
