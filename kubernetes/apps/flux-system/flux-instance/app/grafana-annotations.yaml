---
apiVersion: notification.toolkit.fluxcd.io/v1beta3
kind: Provider
metadata:
  name: grafana-annotations
  namespace: flux-system
spec:
  type: grafana
  address: http://grafana.observability.svc.cluster.local/api/annotations
  secretRef:
    name: grafana-annotations-token
---
apiVersion: notification.toolkit.fluxcd.io/v1beta3
kind: Alert
metadata:
  name: grafana-annotations-reconciles
  namespace: flux-system
spec:
  providerRef:
    name: grafana-annotations
  eventSeverity: info
  eventMetadata:
    flux_event: change
  # Match messages that strongly indicate a meaningful change (new revision applied,
  # resources applied, Helm upgrade succeeded, etc.).
  inclusionList:
    - '(?i).*\\b(applied revision|applied.*revision)\\b.*'
    - '(?i).*\\b(configured|created|deleted)\\b.*'
    - '(?i).*\\b(fetched revision|stored artifact|artifact.*stored|new artifact)\\b.*'
    - '(?i).*\\b(helm (upgrade|install|rollback) succeeded|upgrade succeeded|release.*upgraded|chart.*upgraded)\\b.*'
  eventSources:
    - kind: Kustomization
      name: "*"
      namespace: arc-systems
    - kind: HelmRelease
      name: "*"
      namespace: arc-systems
    - kind: Kustomization
      name: "*"
      namespace: backstage
    - kind: HelmRelease
      name: "*"
      namespace: backstage
    - kind: Kustomization
      name: "*"
      namespace: cert-manager
    - kind: HelmRelease
      name: "*"
      namespace: cert-manager
    - kind: Kustomization
      name: "*"
      namespace: cnpg-dr
    - kind: HelmRelease
      name: "*"
      namespace: cnpg-dr
    - kind: Kustomization
      name: "*"
      namespace: cnpg-system
    - kind: HelmRelease
      name: "*"
      namespace: cnpg-system
    - kind: Kustomization
      name: "*"
      namespace: default
    - kind: HelmRelease
      name: "*"
      namespace: default
    - kind: Kustomization
      name: "*"
      namespace: flux-system
    - kind: HelmRelease
      name: "*"
      namespace: flux-system
    - kind: Kustomization
      name: "*"
      namespace: freshrss
    - kind: HelmRelease
      name: "*"
      namespace: freshrss
    - kind: Kustomization
      name: "*"
      namespace: invoiceninja
    - kind: HelmRelease
      name: "*"
      namespace: invoiceninja
    - kind: Kustomization
      name: "*"
      namespace: kube-system
    - kind: HelmRelease
      name: "*"
      namespace: kube-system
    - kind: Kustomization
      name: "*"
      namespace: longhorn-system
    - kind: HelmRelease
      name: "*"
      namespace: longhorn-system
    - kind: Kustomization
      name: "*"
      namespace: network
    - kind: HelmRelease
      name: "*"
      namespace: network
    - kind: Kustomization
      name: "*"
      namespace: observability
    - kind: HelmRelease
      name: "*"
      namespace: observability
    - kind: Kustomization
      name: "*"
      namespace: searxng
    - kind: HelmRelease
      name: "*"
      namespace: searxng
    - kind: Kustomization
      name: "*"
      namespace: sparkyfitness
    - kind: HelmRelease
      name: "*"
      namespace: sparkyfitness
---
apiVersion: notification.toolkit.fluxcd.io/v1beta3
kind: Alert
metadata:
  name: grafana-annotations-errors
  namespace: flux-system
spec:
  providerRef:
    name: grafana-annotations
  eventSeverity: error
  eventMetadata:
    flux_event: error
  eventSources:
    - kind: Kustomization
      name: "*"
      namespace: arc-systems
    - kind: HelmRelease
      name: "*"
      namespace: arc-systems
    - kind: Kustomization
      name: "*"
      namespace: backstage
    - kind: HelmRelease
      name: "*"
      namespace: backstage
    - kind: Kustomization
      name: "*"
      namespace: cert-manager
    - kind: HelmRelease
      name: "*"
      namespace: cert-manager
    - kind: Kustomization
      name: "*"
      namespace: cnpg-dr
    - kind: HelmRelease
      name: "*"
      namespace: cnpg-dr
    - kind: Kustomization
      name: "*"
      namespace: cnpg-system
    - kind: HelmRelease
      name: "*"
      namespace: cnpg-system
    - kind: Kustomization
      name: "*"
      namespace: default
    - kind: HelmRelease
      name: "*"
      namespace: default
    - kind: Kustomization
      name: "*"
      namespace: flux-system
    - kind: HelmRelease
      name: "*"
      namespace: flux-system
    - kind: Kustomization
      name: "*"
      namespace: freshrss
    - kind: HelmRelease
      name: "*"
      namespace: freshrss
    - kind: Kustomization
      name: "*"
      namespace: invoiceninja
    - kind: HelmRelease
      name: "*"
      namespace: invoiceninja
    - kind: Kustomization
      name: "*"
      namespace: kube-system
    - kind: HelmRelease
      name: "*"
      namespace: kube-system
    - kind: Kustomization
      name: "*"
      namespace: longhorn-system
    - kind: HelmRelease
      name: "*"
      namespace: longhorn-system
    - kind: Kustomization
      name: "*"
      namespace: network
    - kind: HelmRelease
      name: "*"
      namespace: network
    - kind: Kustomization
      name: "*"
      namespace: observability
    - kind: HelmRelease
      name: "*"
      namespace: observability
    - kind: Kustomization
      name: "*"
      namespace: searxng
    - kind: HelmRelease
      name: "*"
      namespace: searxng
    - kind: Kustomization
      name: "*"
      namespace: sparkyfitness
    - kind: HelmRelease
      name: "*"
      namespace: sparkyfitness
    - kind: GitRepository
      name: "*"
      namespace: flux-system
    - kind: OCIRepository
      name: "*"
      namespace: flux-system
    - kind: HelmRepository
      name: "*"
      namespace: flux-system
    - kind: Bucket
      name: "*"
      namespace: flux-system
